---
import { getCollection } from "astro:content";

import type { StyledProps } from "@/types";

import Decorator from "@/components/common/Decorator.astro";
import Link from "@/components/common/Link.astro";

import { indexType } from "@/consts";
import { createRouteUrl } from "@/lib/utils";

interface Props extends StyledProps {}

const { class: className = "", style: styleAttr = "" } = Astro.props;

const categories = await getCollection(
  "postIndex",
  (index) => index.data.type === indexType.Categories,
);
---

<div class:list={[className, "card space-y-1 px-4 py-2"]} style={styleAttr}>
  <Decorator>Categories</Decorator>
  <ul>
    {
      categories.map((category) => (
        <li>
          <Link
            class="text-foreground/70 hover:text-accent flex items-center text-sm transition-colors"
            href={createRouteUrl("index", category.id)}
          >
            <span class="truncate">{category.data.name}</span>
            <span class="text-foreground/50 ml-1 text-xs">
              ({category.data.count})
            </span>
          </Link>
        </li>
      ))
    }
  </ul>
</div>
