---
import type { GetStaticPaths } from "astro";
import { getCollection } from "astro:content";

import MainLayout from "@/layouts/MainLayout.astro";
import Link from "@/components/common/Link.astro";
import Pagination from "@/components/ui/Pagination.astro";
import PostItem from "@/components/post/PostItem.astro";

import { themeConfig } from "@/consts";
import { createRouteUrl } from "@/lib/utils";

export const getStaticPaths = (async ({ paginate }) => {
  const posts = await getCollection("posts");
  return paginate(posts, { pageSize: themeConfig.postPerPage });
}) satisfies GetStaticPaths;

const { page } = Astro.props;
const posts = page.data;
---

<MainLayout>
  <div class="space-y-2">
    <ul class="anim-delay-sequence space-y-2">
      {
        posts.map((post, index) => (
          <li class="anim-onload" style={`--i: ${index}`}>
            <Link href={createRouteUrl("blog", post.id)}>
              <PostItem post={post} />
            </Link>
          </li>
        ))
      }
    </ul>
    <Pagination
      class="anim-onload flex items-center justify-center gap-0.5"
      style="--initialDelay: 300ms"
      current={page.currentPage}
      prev={page.url.prev}
      next={page.url.next}
      first={page.url.first}
      last={page.url.last}
    />
  </div>
</MainLayout>
